#!/bin/sh

set -e

OUT=@ABS_TOP_SRCDIR@/src/dummy-strings.c
# rebuild dummy strings for translation from Kerberos sources
ET_SUBDIR="src/lib/krb5/"
# ignore these to reduce translatable strings
ET_IGNORE="(kdb5_err|krb524|KRB5PLACEHOLD)"

if [ -z "${ET_DIR}" ]; then
    echo "Need to set ET_DIR to Kerberos sources"
    exit 1
fi

echo '/* Generated by hand via "cd etpo; make update-etpo" from ${ET_DIR} */' > "${OUT}".tmp
@ABS_BUILDDIR@/etpo ${ET_DIR}/${ET_SUBDIR} | egrep -v "${ET_IGNORE}" >> "${OUT}".tmp
mv -f "${OUT}".tmp "${OUT}"
